<link rel="import" href="../geohash-js/geohash-js.html">
<link rel="import" href="../iron-ajax/iron-ajax.html">

  <dom-module id="geo-hash-data">

    <template>
      <span>{{count}}</span>
      <iron-ajax url="{{input}}" last-response="{{data}}" auto></iron-ajax>
    </template>
    
    <script>
      
(function() {
  Polymer({
    is: 'geo-hash-data',
    properties: {
      output: {
        computed: "process(data)"
      },
      input: {
        type: String,
        value: "https://essentialhotels.co.uk/index.json"
      },
      count: {
        type: Number,
        value:0
      }
    },
    process: function(data) {
      var output = {};
      var count = 0;
      //
      if (data != null) {
        Object.keys(data).forEach(function(key) {
          if (data[key].hasOwnProperty("LatLng")) { 
            
            console.log(key, data[key].LatLng);
            
            var latlng = data[key].LatLng.split(",");
            
            console.log(encodeGeoHash(+latlng[1], +latlng[0]));
            
            count++; 
          }
        });
      }
      this.count = count;
      console.log(output);
      // encodeGeoHash(+lng, +lat);
      return {
        num: count,
        output: output
      };
    }
  });
})();
    </script>
  </dom-module>
